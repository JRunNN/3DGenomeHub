import{_ as ie,a as de,b as ue,c as ge,d as pe,e as me,f as fe,g as he,h as be,i as ve,j as _e,k as ke}from"./TrackListCellType.vue_vue_type_style_index_0_scoped_df7bc221_lang-5f1fa960.js";import{d as ye,r,m as j,o as xe,q as Ce,b as w,c as v,h as B,j as _,w as b,F as U,k as P,e as G,u as k,g as a,t as T,s as Se,v as we,D as Te,C as L,y as E,f as N}from"./index-fe3c5ff0.js";import{T as De}from"./TrackListCellType-1be9ad6b.js";import{u as ze,a as Ie}from"./SessionStore-0dc0f2c7.js";import{u as je}from"./use-loading-bar-b8eea68e.js";const Be={class:"w-full"},Ge={class:"flex justify-between"},Le={class:"mb-4 flex items-center min-h-[28px]"},Ae={class:"text-sm font-medium text-gray-900 dark:text-white mr-3 flex-shrink-0"},qe=a("div",{class:"mb-4 flex items-center"},null,-1),Me={class:"ml-8 mr-8 mb-4 flex w-18 items-center"},Re=a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"h-5 w-5"},[a("path",{"fill-rule":"evenodd",d:"M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z","clip-rule":"evenodd"})],-1),Ue=[Re],Pe={class:"gap-3"},$e=ye({__name:"CellType",setup(Ee){const F=ze(),u=Ie(),d=Te().params.id;console.log(d);const D=je(),g=r(!0),A=r([]),p=r(1),m=r(10);r([]);const y=r(0),V=j(()=>({page:p.value,pageCount:Math.ceil(y.value/m.value),pageSize:m.value,itemCount:y.value})),H=j(()=>(p.value-1)*m.value+1),O=j(()=>Math.min(p.value*m.value,y.value)),z=r(null),W=t=>{L.get("/api/search/datalist",{responseType:"json",params:{cellId:d},paramsSerializer:{indexes:null}}).then(e=>{console.log("data recevied"),console.log(e.data),g.value=!1,z.value=e.data.data[0],D.finish()}).catch(function(e){e.response?(console.log(e.response.data),console.log(e.response.status),console.log(e.response.headers)):e.request?console.log(e.request):console.log("Error",e.message),console.log(e.config)})},f=r({cellId:d,pagesize:m.value,page:p.value}),x=r(""),$=()=>{f.value=Object.assign(f.value,{geneName:x.value})};let i=r({});X(u.getSessionList,d)?(u.targetedSession.length=0,u.targetedSession.push(d),i.value=u.getTargtedSession,console.log(i)):i.value={key:d,trackIds:[],sessionConfig:{type:"TrackList",maxTrackNum:10}};const J=[{id:"hg38-ucsc-gene-annotation-2",name:"UCSC Gene annotation",label:"UCSC Gene annotation",type:"GeneTrack",url:"/data/annotation/UCSC_gene_annotation_hg38.srt.reformat.txt.gz"}],K=async(t,e)=>{e.loadingStatus="loading",console.log(e);const o=await M(e.type);return console.log(o),o.key=String(e.id),o.trackConfig.sessionId.push(t),o.trackConfig.name=e.name,o.trackConfig.label=e.label,o.option.url=e.url,e.loadingStatus="loaded",o},h=r([]),Q=t=>{L.get("/api/search/celltype",{responseType:"json",params:{cellId:t},paramsSerializer:{indexes:null}}).then(e=>{console.log("data recevied"),console.log(e.data);const o=e.data.data1.filter((s,c,S)=>S.indexOf(s)===c);g.value=!1;const l=o.map(s=>Y(t,s));l.push(K(i.value.key,J[0])),console.log(l),Promise.all(l).then(s=>{h.value.push(),h.value.push(...s),console.log(h.value);for(let c=0;c<h.value.length;c++)F.addTrackList(h.value[c],!1,!0),i.value.trackIds.push(h.value[c].key);console.log(i),u.addSession(i.value),u.targetedSession.length=0,u.targetedSession.push(t)}).catch(s=>{console.error(s)}),console.log(h.value),D.finish()}).catch(function(e){e.response?(console.log(e.response.data),console.log(e.response.status),console.log(e.response.headers)):e.request?console.log(e.request):console.log("Error",e.message),console.log(e.config)})};function X(t,e){return t.find(o=>o.key===e)!==void 0}const Y=async(t,e)=>{e.loadingStatus="loading",console.log(e);let o,l,s;switch(e.format){case"bedpe":o="/data/3D_loops/"+e.data_id+"_WashU.bed.gz",l="CurvTrack",s="basicCurve";break;case"hic":o="/data/3D_hic/"+e.data_id+".hic",l="HicTrack",s="triangle";break;case"bed":l="SclsTrack";break;case"bigwig":o="/data/3D_bigwig/"+e.data_id+".bigWig",l="LineGTrack",s="Coverage";break}const c=e.cell_type_summary.cell_id+" | "+e.assay+" | "+s,S=e.cell_type_summary.cell_id+" | "+e.assay+" | "+s,n=await M(l);return n.key=String(e.data_id+e.format+e.assay),n.trackConfig.sessionId.push(t),n.option.url=o,n.trackConfig.name=S,n.trackConfig.label=c,s&&(n.option.style=s),e.loadingStatus="loaded",console.log(n),n},q=Object.assign({"/src/browser/tracks/CurvTrack/config.ts":ie,"/src/browser/tracks/GeneTrack/config.ts":de,"/src/browser/tracks/HeatmapGTrack/config.ts":ue,"/src/browser/tracks/HicTrack/config.ts":ge,"/src/browser/tracks/InterChromCurvTrack/config.ts":pe,"/src/browser/tracks/LineGTrack/config.ts":me,"/src/browser/tracks/MclsTrack/config.ts":fe,"/src/browser/tracks/NetworkTrack/config.ts":he,"/src/browser/tracks/PclsTrack/config.ts":be,"/src/browser/tracks/SclsTrack/config.ts":ve,"/src/browser/tracks/SeqTrack/config.ts":_e,"/src/browser/tracks/VirtualCTrack/config.ts":ke}),Z=Object.keys(q),M=async t=>{try{const e=Z.find(l=>l.includes(`${t}`)),o=await q[e];return new o.default}catch(e){return console.error(`Error while creating component of type ${t}: `,e),null}},ee=[{title:"chrom1",key:"chrom1"},{title:"start1",key:"start1"},{title:"end1",key:"end1"},{title:"chrom2",key:"chrom2"},{title:"start2",key:"start2"},{title:"end2",key:"end2"},{title:"Counts",key:"counts"},{title:"Anchor1",key:"anchor1"},{title:"Anchor2",key:"anchor2"},{title:"data_id",key:"file_id"},{title:"Action",key:"actions",render:function(t){return E("svg",{class:"w-4 h-4 text-grey-500 hover:text-blue-500 cursor-pointer transition-colors duration-300","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 18 18",onClick:e=>{te(t)}},[E("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 11v4.833A1.166 1.166 0 0 1 13.833 17H2.167A1.167 1.167 0 0 1 1 15.833V4.167A1.166 1.166 0 0 1 2.167 3h4.618m4.447-2H17v5.768M9.111 8.889l7.778-7.778"})])}}],R=r({}),te=t=>{console.log(t),console.log("SVG clicked!"),R.value={chrom:t.chrom1,start:t.start1,end:t.end2}},oe=t=>{g.value||(p.value=t,g.value=!0)},se=t=>{},C=r({}),ae=t=>{C.value=t,console.log(C.value)},ne=()=>{p.value=1,m.value=10,x.value="",f.value={cellId:d,pagesize:m.value,page:p.value}},le=()=>{const t={chrom:C.value.chrom,start:C.value.start,end:C.value.end,geneName:""};x.value="",f.value=Object.assign(f.value,t),console.log(f.value)},re=()=>{console.log(res)},ce=t=>{g.value=!0,L.get("/api/search/chromloops",{responseType:"json",params:t,paramsSerializer:{indexes:null}}).then(e=>{console.log(t),console.log("data recevied"),console.log(e.data),g.value=!1,y.value=e.data.count,A.value=e.data.results,D.finish()}).catch(function(e){e.response?(console.log(e.response.data),console.log(e.response.status),console.log(e.response.headers)):e.request?console.log(e.request):console.log("Error",e.message),console.log(e.config)})};return xe(()=>{W(),Q(d),Ce(()=>f,t=>{console.log(t.value),D.start(),ce(t.value)},{immediate:!0,deep:!0})}),(t,e)=>{const o=w("n-descriptions-item"),l=w("n-tag"),s=w("n-descriptions"),c=w("n-card"),S=w("n-data-table");return v(),B("div",Be,[_(c,{bordered:!0,segmented:{content:!0},class:"mb-6","header-style":"font-size: 20px;background-color: #D8D8D8;color: #09253D;padding-top: 4px;padding-bottom: 4px;",size:"small",title:"Cell information"},{default:b(()=>[_(s,{class:"text-lg",column:"1","label-placement":"left",size:"large"},{default:b(()=>[t.prop!=="assays"?(v(!0),B(U,{key:0},P(z.value,(n,I)=>(v(),G(o,{label:I,class:"font-bold",key:I},{default:b(()=>[N(T(n),1)]),_:2},1032,["label"]))),128)):(v(),G(o,{key:1,label:t.prop,class:"font-bold"},{default:b(()=>[(v(!0),B(U,null,P(z.value[t.prop],(n,I)=>(v(),G(l,{"label-style":"font-weight: bold;"},{default:b(()=>[N(T(n.isArray(t.value)?t.value.join(", "):t.value),1)]),_:2},1024))),256))]),_:1},8,["label"]))]),_:1})]),_:1}),_(c,{bordered:!0,segmented:{content:!0},class:"mb-6","header-style":"font-size: 20px;background-color: #D8D8D8;color: #09253D;padding-top: 4px;padding-bottom: 4px;",size:"small",title:"Genome Browser"},{default:b(()=>[_(De,{session:k(i),sessionId:k(i).key,tracks:k(i).trackIds,onUpdateCorenavStore:ae,highlightedRegion:R.value},null,8,["session","sessionId","tracks","highlightedRegion"])]),_:1}),_(c,{bordered:!0,segmented:{content:!0},class:"mb-6","header-style":"font-size: 20px;background-color: #D8D8D8;color: #09253D;padding-top: 4px;padding-bottom: 4px;",size:"small",title:"Chromatin interactions"},{default:b(()=>[a("div",Ge,[a("div",Le,[a("span",Ae," Showing "+T(k(H))+" to "+T(k(O))+" cell types of "+T(y.value)+" in total. ",1)]),qe,a("form",Me,[Se(a("input",{type:"text",id:"simple-search",class:"relative m-0 block min-w-0 flex-auto rounded-l border border-solid border-neutral-300 bg-transparent bg-clip-padding px-3 py-1.5 text-base font-normal text-neutral-700 outline-none transition duration-300 ease-in-out focus:border-primary focus:text-neutral-700 focus:shadow-te-primary focus:outline-none",placeholder:"Search gene names ...",required:"","onUpdate:modelValue":e[0]||(e[0]=n=>x.value=n)},null,512),[[we,x.value]]),a("button",{class:"relative flex items-center mr-3 px-4 py-2.5 text-white rounded-r bg-blue-700 transition duration-150 ease-in-out hover:bg-primary-700 hover:shadow-lg focus:bg-primary-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-primary-800 active:shadow-lg",type:"button",id:"location-search","data-te-ripple-init":"","data-te-ripple-color":"light",onClick:$},Ue)]),a("div",{class:"mb-4 flex items-center",role:"group"},[a("button",{type:"button",class:"text-blue-700 border border-blue-700 hover:bg-blue-700 hover:text-white focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-l text-sm text-center inline-flex items-center p-2 h-10",onClick:le}," Sync "),a("button",{type:"button",class:"text-blue-700 border-t border-b border-r border-blue-700 hover:bg-blue-700 hover:text-white focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-r text-sm text-center inline-flex items-center p-2 h-10",onClick:ne}," Reload ")]),a("div",{class:"ml-10 mb-4 flex items-center",role:"group"},[a("button",{type:"button",class:"text-blue-700 border border-blue-700 hover:bg-blue-700 hover:text-white focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded text-sm text-center inline-flex items-center p-2 h-10",onClick:re}," Export ")])]),a("div",Pe,[_(S,{remote:"",bordered:!1,columns:ee,loading:g.value,data:A.value,pagination:k(V),"onUpdate:page":oe,"onUpdate:sorter":se},null,8,["loading","data","pagination"])])]),_:1})])}}});export{$e as default};
